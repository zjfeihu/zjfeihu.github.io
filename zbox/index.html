<!DOCTYPE html>
<html><head>
<meta charset=utf-8>
<title>zbox</title>
<style>
body{color:#333; font-family:微软雅黑; margin:16px; line-height:1.8}
code{font-family:"Lucida Sans Unicode"; font-weight:bold; color:#b0812c; margin-right:6px}
code em{color:green; font-weight:normal; padding:0 4px; font-style:normal}
</style>
<script src="zbox_files/a.htm"></script>
<style type="text/css">.hl-view{margin:12px 0;}.hl-view .code{display:none;}.hl-view ol{    font:14px/2 monaco,"Courier New",verdana,Helvetica,Tahoma,Arial,sans-serif;    word-wrap:break-word;    word-break:break-all;    dis_display:inline-block\9;    margin:0;    padding-left:4em;}.hl-view li{line-height:1.8;padding-left: 6px;}.hl-edit .view-default {display:none}.view-default ol{background:#eee;color:#333;border-radius:8px;border:1px solid #3C78B5;}.view-default li{line-height:1.8;border-left:1px dotted #3C78B5;padding-left: 6px;}.view-default .tag{color:#0000C6}.view-default .attrval{color:#666666}.view-default .attrkey{color:#FF0000}.view-default .doctype{color:#008074}.view-default .keyword{color:#0000C6}.view-default .comment{color:#B0812C}.view-default .quote{color:#666666}.view-default .number{color:#FF0000}.view-default .regexp{color:#008074}.view-default .csssel{color:#008074}.view-default .csskey{color:#FF0000}.view-default .cssval{color:#666666}.hl-edit .view-black {display:none}.view-black ol{background:#060606;color:#eee;border:1px solid #060606;}.view-black li{background:#222;border-left:1px solid #333;}.view-black .tag{color:#119BEE}.view-black .attrval{color:#888}.view-black .attrkey{color:#89D726}.view-black .doctype{color:#89D726}.view-black .keyword{color:#FE81F8}.view-black .comment{color:#119BEE}.view-black .quote{color:#89D726}.view-black .number{color:#86CC99}.view-black .regexp{color:#B7B700}.view-black .csssel{color:#FE81F8}.view-black .csskey{color:#119BEE}.view-black .cssval{color:#89D726}.hl-edit .view-bop {display:none}.view-bop ol{background:#060606;color:#eee;border:1px solid #060606;}.view-bop li{background:#222;border-left:1px solid #333;}.view-bop .tag{color:#efac32}.view-bop .attrval{color:#d9d762}.view-bop .attrkey{color:#6c99bb}.view-bop .doctype{color:#efac32}.view-bop .keyword{color:#ef5d32}.view-bop .comment{color:#777777}.view-bop .quote{color:#d9d762}.view-bop .number{color:#6c99bb}.view-bop .regexp{color:#8856d2}.view-bop .csssel{color:#efac32}.view-bop .csskey{color:#c0c0c0}.view-bop .cssval{color:#d9d762}.hl-edit{border:1px solid #999;background:#eee;margin:12px 0;}.hl-edit .view-html,.hl-edit .view-css,.hl-edit .view-js{display:none;}.hl-edit .code{overflow:hidden;margin:3px;padding:3px;border:1px solid #999;background:#fff;font-size:12px;}.hl-edit .code textarea{    font:12px/1.6 monaco,"Courier New",verdana,Helvetica,Tahoma,Arial,sans-serif;    border:0;    min-height:240px;    _height:240px;    display:block;    width:100%;    resize:none;    outline:none;}.hl-edit .code div{border-top:1px solid #999;padding-top:3px;}.hl-edit .code div span{color:green;}.hl-menu{position:absolute;background:#FFFFFF;border:1px solid #999;font-size:12px;top:0;left:-999px;padding:1px;width:100px;}.hl-menu a{display:block;padding:3px 12px;color:#333;text-decoration:none!important;}.hl-menu a:hover{background:#316AC5;color:#fff;}.hl-exec{z-index:9999;display:none;position:fixed;left:0;top:0;width:100%;height:400px;background:#fff;}.hl-exec .close{margin:3px auto;width:400px;padding:8px;font-size:12px;font-weight:bold;cursor:pointer;text-align:center;background:#fefefe;border:1px solid #999;color:#FF0000;}.hl-exec .close:hover{background:#feefff;}.hl-exec iframe{border-top:1px solid #000}</style></head><body>

<h1>zbox2.7帮助文档</h1>

<h3>描述</h3>
<p>zbox是一款可自由扩展的js服务器，服务器绿色，小巧，使用方便，可随身携带。</p>

<h3>使用方法</h3>
<ol>
    <li>打开conf目录下的httpd.thash文件进行虚拟主机配置</li>
    <li>启动zbox.exe</li>
    <li>绑定host（打开C:\WINDOWS\system32\drivers\etc\hosts文件添加绑定）</li>
    <li>在浏览器中输入绑定的域名进行访问</li>
</ol>

<h3>httpd.thash配置文件说明</h3>
<div class="hl-view" edit="off">                <div class="view-default"><ol><li>ROOTPATH&nbsp;E:\sschen86
\wwwroot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;;
全局根目录</li><li>DIRINDEX&nbsp;index.html&nbsp;<span class="keyword">default</span>.html&nbsp;index.jhtml&nbsp;index.php&nbsp;&nbsp;&nbsp;&nbsp;;;;默认首页</li><li>HOSTS&nbsp;&nbsp;&nbsp;&nbsp;;;;主机信息</li><li>&nbsp;&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebao.com&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;;
虚拟主机域名</li><li>&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebao&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;;
网站根目录，相对于ROOTPATH</li><li>&nbsp;&nbsp;&nbsp;&nbsp;codepage&nbsp;&nbsp;&nbsp;&nbsp;<span class="number">65001</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;;网站编码，默认是<span class="number">936</span>，即gbk</li><li>&nbsp;&nbsp;&nbsp;&nbsp;script&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;php&nbsp;css&nbsp;js&nbsp;jhtml&nbsp;&nbsp;&nbsp;;;;
设置哪些类型的文件使用脚本引擎，脚本引擎会解释“”标记当中的语句</li><li>HOSTS</li><li>&nbsp;&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blog.cc:<span class="number">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;;未设置网站根目录，则取domain为根目录，这里是&nbsp;blog.cc#<span class="number">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>&nbsp;&nbsp;&nbsp;&nbsp;script&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jhtml</li><li>HOSTS</li><li>&nbsp;&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z011.js</li><li>&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D:<span class="keyword"></span><span class="comment"></span><span class="regexp">/zjs/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;;网站根目录也可以直接设置绝对路径</li><li>&nbsp;&nbsp;&nbsp;&nbsp;script&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jhtml&nbsp;jjs&nbsp;jcss&nbsp;js&nbsp;css&nbsp;zjs</li></ol></div>            </div>
<p>只要按上面的格式添加一组HOSTS即可添加一个虚拟主机</p>

<h3>服务器API</h3>
<p>服务器API分为顶级API和模板API，顶级API为系统API和组件API，可以在任何地方使用，模板API为zero组件环境中的API，只能在模板环境中使用</p>

<h3>顶级API</h3>

<h4>外置模板引擎</h4><ul><li><code>$rtpl(<em>tpl, data</em>)</code>    tpl为模板字符串，data为数据</li></ul><h4>文件操作模块</h4><ul><li><code>fs.codepage(<em>cp</em>)</code> 设置默认编码</li><li><code>fs.info(<em>path</em>)</code> 获取文件信息</li><li><code>fs.isdir(<em>path</em>)</code> 判断是否为目录</li><li><code>fs.isfile(<em>path</em>)</code> 判断是否为文件</li><li><code>fs.exists(<em>path</em>)</code> 判断是否存在</li><li><code>fs.remove(<em>path, bForce</em>)</code> 删除文件</li><li><code>fs.readbin(<em>path</em>)</code> 读取二进制</li><li><code>fs.readtext(<em>path, cp</em>)</code> 读取文本</li><li><code>fs.writebin(<em>path</em>)</code> 写入二进制</li><li><code>fs.writetext(<em>path, text, cp</em>)</code> 写入文本</li><li><code>fs.makedir(<em>path</em>)</code> 创建文件夹</li><li><code>fs.foreach(<em>path, callback, deep</em>)</code> 遍历文件夹</li><li><code>fs.copy(<em>from, to</em>)</code> 复制文件</li><li><code>fs.path(<em>path</em>)</code>       格式化路径</li><li><code>fs.ext(<em>path</em>)</code>       返回文件扩展名</li></ul><h4>js压缩模块</h4><ul><li><code>packer.pack(<em>code</em>)</code>     压缩js代码</li></ul><h4>服务器请求模块</h4><ul><li><code>request.init(<em>option</em>)</code> 初始化</li><li><code>request.header(<em>key</em>)</code> 获取请求头</li><li><code>request.query(<em>key</em>)</code> 获取查询字段</li><li><code>request.form(<em>key</em>)</code> 获取post数据</li></ul><h4>服务器响应模块</h4><ul><li><code>response.init(<em>options</em>)</code> 初始化</li><li><code>response.header(<em>key, val</em>)</code> 添加自定义响应头</li><li><code>response.bfsize(<em>len</em>)</code> 设置buffer大小，可以设置为0</li><li><code>response.flush(<em></em>)</code> 输出缓存</li><li><code>response.end(<em></em>)</code> 输出并且结束进程</li><li><code>response.write(<em>text</em>)</code> 输出文本</li><li><code>response.binwrite(<em>data</em>)</code> 输出二进制数据</li><li><code>response.content(<em></em>)</code> 获取输出的内容</li></ul><h4>thash解析模块</h4><ul><li><code>thash.parse(<em>text</em>)</code>   转换成JSON对象</li></ul><h4>模板引擎zero</h4><ul><li><code>zero(<em>path, codepage</em>)</code> 调用模板引擎</li><li><code>zero.deps(<em>path, codepage</em>)</code> 获取模板文件的依赖</li></ul><h4>系统核心模块</h4><ul><li><code>netbox</code>                          netbox对象</li><li><code>shell</code>                           shell对象</li><li><code>system.appname</code>                  服务器名称</li><li><code>system.create(<em>progid</em>)</code>           创建内置对象</li><li><code>system.require(<em>path, reload</em>)</code>    加载组件，reload控制是否从缓存中获取</li><li><code>system.register(<em>name, module</em>)</code>   注册服务器级组件，当只有name参数时，则从modules目录下加载同名模块</li><li><code>system.log(<em>msg</em>)</code>                 控制台输出信息</li><li><code>system.alert(<em>msg</em>)</code>               弹窗输出信息</li><li><code>system.error(<em>title, info</em>)</code>       控制台输出错误信息</li><li><code>system.utils.mix(<em>target, source</em>)</code> 添加数据到目标，会覆盖已经存在的键</li><li><code>system.utils.rstr(<em>str, data</em>)</code> 简化模板函数</li><li><code>system.utils.execjs(<em>name, code, imports, debug</em>)</code> 类似eval，不过内部附带debug模式，允许传入API</li></ul><h4>控制台模块</h4><ul><li><code>system.console.log(<em>data</em>)</code> 控制台输出</li><li><code>system.console.alert(<em>data</em>)</code> 弹窗输出</li><li><code>system.lines(<em>n</em>)</code> 输出空白行，默认一屏</li></ul><h4>环境变量管理组件</h4><ul><li><code>system.global.value(<em>keys, deep</em>)</code>                 获取全局变量的值，value('a.b.c')查询global['a.b.c']，假如deep为真，则查询global.a.b.c</li><li><code>system.global.register(<em>key, value, issystem</em>)</code>    注册全局组件，通过issystem控制是服务器级别的还是网站级别的，服务器级别的变量无法被清除</li><li><code>system.global.clean(<em>deep</em>)</code>                       清除用户变量，deep为真时连同网站级别的变量也清除</li></ul><h4>服务器模块</h4><ul><li><code>system.server.route(<em>socket</em>)</code>     服务器路由函数</li><li><code>system.server.on(<em>events</em>)</code>     服务器接口重写<br>system.server.on({<br>&nbsp;&nbsp;&nbsp;&nbsp;rewrite:function(url){},//重定向<br>&nbsp;&nbsp;&nbsp;&nbsp;close:function(){},//请求关闭时执行<br>&nbsp;&nbsp;&nbsp;&nbsp;render:function(){}//替换系统渲染<br>})</li><li><code>system.server.context</code>       服务器环境数据</li></ul>


<h3>模板API</h3>
<h4>zero 模板内置API</h4><ul><li><code>$PATH</code> 当前模板文件的物理位置</li><li><code>$GET</code> 客户端get方式发送的数据</li><li><code>$HTTPPATH</code> 当前网站地址</li><li><code>$ROOTPATH</code> 当前网站根目录</li><li><code>$CODEPAGE</code> 当前网站编码</li><li><code>$zero(<em>path, codepage</em>)</code> 调用模板引擎</li><li><code>$mappath(<em>path</em>)</code> 获取文件物理位置</li><li><code>$inc(<em>path</em>)</code> 加载模板文件</li><li><code>$require(<em>path</em>)</code> 加载组件</li><li><code>$input(<em>path, codepage</em>)</code> 读取文本文件</li><li><code>$output(<em>path, codepage</em>)</code> 写入文本文件</li><li><code>$push(<em>text</em>)</code> 输出内容</li><li><code>$each(<em>data, callback</em>)</code> 类似Array.forEach</li><li><code>$rstr(<em>str, data</em>)</code> 同system.rstr</li></ul>

<h3>文件命名建议</h3>
<ul>
    <li>模板文件：以tpl作为前缀扩展名，通过$inc来使用，比如：header.tpl.html，skin.tpl.css，setTab.tpl.js</li>
    <li>模块文件：以mjs作为扩展名，通过$require来使用，比如：Math.mjs</li>
    <li>动态文件：以就j(html|css|js)作为扩展名，直接通过浏览器访问，比如：index.jhtml，index.jcss，index.jjs</li>
    <li>动态编译文件：以!(html|css|js)作为扩展名，直接通过浏览器访问，访问时可以省略扩展名前面的叹号，并可以被编译生成静态文件，比如index.!html，index.!css，index.!js</li>
</ul>

<div style="left: -200px;" class="hl-menu">                    <a href="#" jbtn="edit">编辑代码</a>                    <a href="#" jbtn="run">运行代码</a>                    <a href="javascript:alert('%E3%80%8Ahighlight2.0%E3%80%8B\r\nEmail%EF%BC%9Azjfeihu#126.com');void%200">关于插件</a>                </div><div class="hl-exec"><div class="close">点击关闭</div></div></body></html>